function unfade(e){let n=.1;e.style.display="block";const t=setInterval(()=>{n>=1&&clearInterval(t),e.style.opacity=n,e.style.filter=`alpha(opacity=${100*n})`,n+=.1*n},10)}function fade(e){let n=.1;e.style.display="block";const t=setInterval(()=>{parseInt(n)<=0&&(clearInterval(t),e.style.display="none"),e.style.opacity=n,e.style.filter=`alpha(opacity=${100*n})`,n-=.1*n},15)}function show_ans(e,n){const t=document.getElementById(n);"none"==t.style.display?unfade(t):fade(t)}window.type_data={download:50,upload:20};const infost=document.getElementById("info-st");infost.onclick=(()=>{show_ans(this,"spdinfo")});const start_btn=document.getElementById("start_btn");start_btn.onclick=(()=>{show_ans(this,"testarea"),start_btn.innerHTML="Working On It",start_btn.onclick=(()=>{}),dl_req().then(e=>{console.log("DL_REQ"),ul_req()}).then(e=>{start_btn.innerHTML="Final Results"})});const avg_dl=document.getElementById("avg_dl"),avg_ul=document.getElementById("avg_ul"),check_performance=(e,n,t,o="download")=>{let l="MB";const a=window.type_data[o],s=n-e;console.log(a,s,o);let d=a/(s/1e3);d<=.001&&(l="KB",d*=1024),t.innerHTML=`speed:${d.toFixed(3)} ${l}/sec`,t.style.display="block"},dl_req=()=>new Promise((e,n)=>{avg_ul.innerHTML="Upload will begin after the download",avg_ul.style.display="block",fetch("/s/generate-file/").then(e=>e.text()).then(n=>{const t=new XMLHttpRequest;t.open("GET",n),t.setRequestHeader("X-Filesize","max"),t.onload=(n=>{console.log(n),e(check_performance(window.dl_start,performance.now(),avg_dl))}),t.onprogress=(e=>{let n=e.loaded/1048576/((performance.now()-window.dl_start)/1e3),t="MB";n<=.001&&(t="KB",n*=1024),avg_dl.style.display="block",avg_dl.innerHTML=`${n.toFixed(2)}  ${t}/sec`}),window.dl_start=performance.now(),t.send()})}),blobgen=e=>new ArrayBuffer(e),ul_req=async()=>{const e=blobgen(20971520);return avg_ul.innerHTML="Checking Upload Speed",console.log(e),await(async(e,n)=>{const t=performance.now(),o=new XMLHttpRequest;o.open("POST",e),o.upload.onprogress=(e=>{let n=e.loaded/1048576/((performance.now()-window.dl_start)/1e3),t="MB";n<=.001&&(t="KB",n*=1024),avg_ul.style.display="block",avg_ul.innerHTML=`${n.toFixed(2)}  ${t}/sec`}),o.send(n),o.onload=(()=>{check_performance(t,performance.now(),avg_ul,"upload")})})("/s/uploads/",e),"Done"};